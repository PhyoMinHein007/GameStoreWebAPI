@page "/"
@using GameStore.Frontend.Clients
@inject GamesClient gamesClient

<PageTitle>Game Catalog</PageTitle>
<a href="/editgame" class="btn btn-primary mb-3">Add New Game</a>

@if(games is not null)
{
  <table class="table table-bordered table-hover">
  <thead class="table-dark">
    <tr>
      <th>Name</th>
      <th>Genre</th>
      <th>Price</th>
      <th>Release Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    @foreach (var game in games)
    {
      <tr>
        <td>@game.Name</td>
        <td>@game.Genre</td>
        <td>@game.Price.ToString("C2")</td>
        <td>@game.ReleaseDate.ToString("MMMM dd, yyyy")</td>
        <td>
          <div class="d-flex">
            <a class="btn btn-primary me-2" role="button" href="@GameUrl(game.Id)" title="Edit @game.Name">
              <i class="bi bi-pencil"></i>
            </a>
            <button class="btn btn-danger"
                    data-bs-toggle="modal"
                    data-bs-target="@GetDeleteModalId(game)"
                    title="Delete @game.Name">
              <i class="bi bi-trash"></i>
            </button>
          </div>
          <DeleteGame Game="game" />
        </td>
      </tr>
    }
  </tbody>
</table>
}
else
{
  <p><em>Loading...</em></p>
}

@code{
    private GameSummary[]? games;

    protected override void OnInitialized()
    {
        games = gamesClient.GetAllGames();
    }

    private string GameUrl(int Id) => $"/editgame/{Id}";

    private string GetDeleteModalId(GameSummary game) => "#" + DeleteGame.GetModalId(game);

}